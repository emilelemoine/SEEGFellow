<?xml version="1.0" encoding="UTF-8"?>
<ui version="4.0">
 <class>SEEGFellow</class>
 <widget class="qMRMLWidget" name="SEEGFellow">
  <layout class="QVBoxLayout" name="verticalLayout">

   <!-- Step 1: Load Data -->
   <item>
    <widget class="ctkCollapsibleButton" name="loadDataCollapsibleButton">
     <property name="text"><string>Step 1: Load Data</string></property>
     <layout class="QFormLayout" name="loadDataFormLayout">
      <item row="0" column="0"><widget class="QLabel"><property name="text"><string>T1 MRI:</string></property></widget></item>
      <item row="0" column="1"><widget class="ctkPathLineEdit" name="t1PathLineEdit"/></item>
      <item row="1" column="0"><widget class="QLabel"><property name="text"><string>Post-implant CT:</string></property></widget></item>
      <item row="1" column="1"><widget class="ctkPathLineEdit" name="ctPathLineEdit"/></item>
      <item row="2" column="1"><widget class="QPushButton" name="loadButton"><property name="text"><string>Load Volumes</string></property></widget></item>
     </layout>
    </widget>
   </item>

   <!-- Step 2: Rough Alignment -->
   <item>
    <widget class="ctkCollapsibleButton" name="roughAlignCollapsibleButton">
     <property name="text"><string>Step 2: Rough Alignment</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="roughAlignLayout">
      <item><widget class="QLabel" name="roughAlignInstructions"><property name="text"><string>Use the Transforms module to roughly align the CT to the T1. Translate and rotate until the CT skull roughly overlaps the T1.</string></property><property name="wordWrap"><bool>true</bool></property></widget></item>
      <item><widget class="QPushButton" name="createTransformButton"><property name="text"><string>Create Transform</string></property></widget></item>
      <item><widget class="QPushButton" name="openTransformsButton"><property name="text"><string>Open Transforms Module</string></property></widget></item>
      <item><widget class="QPushButton" name="roughAlignDoneButton"><property name="text"><string>Done — Proceed to Registration</string></property></widget></item>
     </layout>
    </widget>
   </item>

   <!-- Step 3: Co-registration -->
   <item>
    <widget class="ctkCollapsibleButton" name="registrationCollapsibleButton">
     <property name="text"><string>Step 3: Co-registration</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="registrationLayout">
      <item><widget class="QPushButton" name="registerButton"><property name="text"><string>Register (BRAINSFit Rigid)</string></property></widget></item>
      <item><widget class="QProgressBar" name="registrationProgressBar"><property name="value"><number>0</number></property></widget></item>
      <item>
       <layout class="QHBoxLayout">
        <item><widget class="QPushButton" name="acceptRegistrationButton"><property name="text"><string>Accept</string></property></widget></item>
        <item><widget class="QPushButton" name="rerunRegistrationButton"><property name="text"><string>Re-run</string></property></widget></item>
       </layout>
      </item>
     </layout>
    </widget>
   </item>

   <!-- Step 4a: Intracranial Mask -->
   <item>
    <widget class="ctkCollapsibleButton" name="intracranialMaskCollapsibleButton">
     <property name="text"><string>Step 4a: Intracranial Mask</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="intracranialMaskLayout">
      <item><widget class="QPushButton" name="computeHeadMaskButton"><property name="text"><string>Compute Intracranial Mask</string></property></widget></item>
      <item>
       <layout class="QHBoxLayout">
        <item><widget class="QPushButton" name="editHeadMaskButton"><property name="text"><string>Edit in Segment Editor</string></property></widget></item>
        <item><widget class="QPushButton" name="acceptHeadMaskButton"><property name="text"><string>Accept</string></property></widget></item>
       </layout>
      </item>
     </layout>
    </widget>
   </item>

   <!-- Step 4b: Metal Threshold -->
   <item>
    <widget class="ctkCollapsibleButton" name="metalThresholdCollapsibleButton">
     <property name="text"><string>Step 4b: Metal Threshold</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="metalThresholdLayout">
      <item>
       <layout class="QFormLayout">
        <item row="0" column="0"><widget class="QLabel"><property name="text"><string>HU Threshold:</string></property></widget></item>
        <item row="0" column="1"><widget class="ctkSliderWidget" name="thresholdSlider"><property name="minimum"><double>500</double></property><property name="maximum"><double>4000</double></property><property name="value"><double>2000</double></property><property name="singleStep"><double>50</double></property></widget></item>
        <item row="1" column="1"><widget class="QLabel" name="voxelCountLabel"><property name="text"><string>—</string></property></widget></item>
       </layout>
      </item>
      <item><widget class="QPushButton" name="applyMetalThresholdButton"><property name="text"><string>Apply Threshold</string></property></widget></item>
      <item>
       <layout class="QHBoxLayout">
        <item><widget class="QPushButton" name="editMetalMaskButton"><property name="text"><string>Edit in Segment Editor</string></property></widget></item>
        <item><widget class="QPushButton" name="acceptMetalMaskButton"><property name="text"><string>Accept</string></property></widget></item>
       </layout>
      </item>
     </layout>
    </widget>
   </item>

   <!-- Step 4c: Contact Detection (LoG) -->
   <item>
    <widget class="ctkCollapsibleButton" name="contactDetectionCollapsibleButton">
     <property name="text"><string>Step 4c: Detect Contacts (LoG)</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="contactDetectionLayout">
      <item>
       <layout class="QFormLayout">
        <item row="0" column="0"><widget class="QLabel"><property name="text"><string>Sigma (mm):</string></property></widget></item>
        <item row="0" column="1"><widget class="ctkSliderWidget" name="sigmaSlider"><property name="minimum"><double>0.5</double></property><property name="maximum"><double>3.0</double></property><property name="value"><double>1.2</double></property><property name="singleStep"><double>0.1</double></property></widget></item>
        <item row="1" column="0"><widget class="QLabel"><property name="text"><string>Contact spacing (mm):</string></property></widget></item>
        <item row="1" column="1"><widget class="QDoubleSpinBox" name="expectedSpacingSpinBox"><property name="minimum"><double>1.5</double></property><property name="maximum"><double>5.0</double></property><property name="value"><double>3.5</double></property><property name="singleStep"><double>0.5</double></property></widget></item>
        <item row="2" column="0"><widget class="QLabel"><property name="text"><string>Min. contacts:</string></property></widget></item>
        <item row="2" column="1"><widget class="QSpinBox" name="minContactsSpinBox"><property name="minimum"><number>2</number></property><property name="maximum"><number>16</number></property><property name="value"><number>3</number></property></widget></item>
        <item row="3" column="0"><widget class="QLabel"><property name="text"><string>Max component voxels:</string></property></widget></item>
        <item row="3" column="1"><widget class="QSpinBox" name="maxComponentVoxelsSpinBox"><property name="minimum"><number>50</number></property><property name="maximum"><number>2000</number></property><property name="value"><number>500</number></property><property name="singleStep"><number>50</number></property></widget></item>
        <item row="4" column="0"><widget class="QLabel"><property name="text"><string>Spacing cutoff (%):</string></property></widget></item>
        <item row="4" column="1"><widget class="ctkSliderWidget" name="spacingCutoffSlider"><property name="minimum"><double>30</double></property><property name="maximum"><double>90</double></property><property name="value"><double>65</double></property><property name="singleStep"><double>5</double></property></widget></item>
        <item row="5" column="0"><widget class="QLabel"><property name="text"><string>RANSAC tolerance (mm):</string></property></widget></item>
        <item row="5" column="1"><widget class="QDoubleSpinBox" name="distanceToleranceSpinBox"><property name="minimum"><double>0.5</double></property><property name="maximum"><double>5.0</double></property><property name="value"><double>2.0</double></property><property name="singleStep"><double>0.5</double></property><property name="suffix"><string> mm</string></property></widget></item>
        <item row="6" column="0"><widget class="QLabel"><property name="text"><string>RANSAC max iterations:</string></property></widget></item>
        <item row="6" column="1"><widget class="QSpinBox" name="maxIterationsSpinBox"><property name="minimum"><number>100</number></property><property name="maximum"><number>10000</number></property><property name="value"><number>1000</number></property><property name="singleStep"><number>100</number></property></widget></item>
       </layout>
      </item>
      <item><widget class="QPushButton" name="detectElectrodesButton"><property name="text"><string>Detect All Electrodes</string></property></widget></item>
     </layout>
    </widget>
   </item>

   <!-- Step 5: Rename Electrodes -->
   <item>
    <widget class="ctkCollapsibleButton" name="renameElectrodesCollapsibleButton">
     <property name="text"><string>Step 5: Rename Electrodes</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="renameElectrodesLayout">
      <item><widget class="QTableWidget" name="electrodeTable"><property name="minimumSize"><size><width>0</width><height>625</height></size></property></widget></item>
      <item><widget class="QPushButton" name="applyNamesButton"><property name="text"><string>Apply Names</string></property></widget></item>
      <item><widget class="QPushButton" name="exportToClipboardButton"><property name="text"><string>Export to Clipboard</string></property></widget></item>
     </layout>
    </widget>
   </item>

   <!-- Step 6: Review &amp; Export -->
   <item>
    <widget class="ctkCollapsibleButton" name="exportCollapsibleButton">
     <property name="text"><string>Results &amp; Export</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="exportLayout">
      <item><widget class="QTableWidget" name="contactTable"/></item>
      <item><widget class="QPushButton" name="exportCsvButton"><property name="text"><string>Export CSV</string></property></widget></item>
     </layout>
    </widget>
   </item>

   <!-- Electrode List -->
   <item>
    <widget class="ctkCollapsibleButton" name="electrodeListCollapsibleButton">
     <property name="text"><string>Electrode List</string></property>
     <property name="collapsed"><bool>true</bool></property>
     <layout class="QVBoxLayout" name="electrodeListLayout">
      <item><widget class="QListWidget" name="electrodeListWidget"/></item>
      <item><widget class="QPushButton" name="deleteElectrodeButton"><property name="text"><string>Delete Selected Electrode</string></property></widget></item>
     </layout>
    </widget>
   </item>

   <item><spacer name="verticalSpacer"><property name="orientation"><enum>Qt::Vertical</enum></property></spacer></item>
  </layout>
 </widget>
</ui>
